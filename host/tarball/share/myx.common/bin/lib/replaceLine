#!/usr/bin/env bash

##### !!! This script is universal for FreeBSD, Darwin, Ubuntu. !!! #####

set -e

#	AFILE="$1"
#	AFROM="$2"
#	AWITH="$3"


# >>>                              <<<
# >>>>>       COPIED  FROM       <<<<<
# >>>                              <<<
# > ../../include/subr-universal.sh  <
# >>>                              <<<

ReplaceLine(){
	local FL="$1" FR="$2" TO="$3"
	[ -z "$FL" ] && echo "ReplaceLine: FL is required!" >&2 && exit 1
	
	grep -q "$FR" $FL && \
		cp -pf "$FL" "$FL.bak" && \
		chmod 664 "$FL.bak" && \
		grep -v "$FR" "$FL.bak" > "$FL" && \
		rm "$FL.bak"
		
	grep -q -x -F "$TO" "$FL" || \
		echo "$TO" >> "$FL"
		
	return 0;
}


case "$0" in
	*/myx.common/bin/lib/replaceLine) 
		ReplaceLine $@
	;;
esac
