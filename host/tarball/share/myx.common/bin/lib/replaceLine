#!/usr/bin/env bash

# This script is universal for FreeBSD, Darwin, Ubuntu. ???

set -e

# >>>                              <<<
# >>>>>       COPIED  FROM       <<<<<
# >>>                              <<<
# > ../../include/subr-universal.sh  <
# >>>                              <<<

InternReplaceLine(){
	local FL="$1" FR="$2" TO="$3"
	
	grep -q "$FR" $FL && \
		cp -pf "$FL" "$FL.bak" && \
		chmod 664 "$FL.bak" && \
		grep -v "$FR" "$FL.bak" > "$FL" && \
		rm "$FL.bak"
		
	grep -q -x -F "$TO" "$FL" || \
		echo "$TO" >> "$FL"
		
	return 0;
}


AFILE="$1"
AFROM="$2"
AWITH="$3"

InternReplaceLine "$AFILE" "$AFROM" "$AWITH"
